%!TEX root = ../thesis.tex

\subsection{既存手法・研究}

因果関係に関する考察は、科学の基本的な問いとして因果推論という文脈で研究されてきた。
近年では計算機科学や統計科学の発展により、経済学やマーケティングの分野でも注目されている\cite{Varian2016-se}。
因果推論は大まかには、
(i)因果構造の同定、と
(ii)因果構造が既知である下での因果関係の大きさの推定、
という2つの問題に分類できる。
(i)因果構造の同定 は、非常に困難な問題であるとされているが、
統計的因果探索と呼ばれる分野で研究されており、
いくつかの仮定の下で識別可能なモデルが提案されている\cite{2017-zx}。
(ii)因果構造が既知である下での因果関係の大きさの推定 は、
ランダム化比較試験を中心とした実験研究と、
特に実験を行わない観察研究の双方において研究されている。

本節では、マーケティング・リサーチにおいて消費者行動の因果関係に関する情報を得る方法として
従来より広く用いられてきた一般的な既存手法について述べた後、
統計的因果探索に関する近年の研究について俯瞰する。

\subsubsection{マーケティング・リサーチにおける既存手法}

マーケティング・リサーチは大きく定性調査と定量調査に分類され、
それぞれにおいて消費者行動の因果関係に関する情報の分析を行う。

定性調査は一般的に、消費者の内部にある意見や態度を理解することで、
マーケティング課題の詳細な定義、仮説の設定、定量調査における調査項目の優先順位の決定、
消費者独自の考え方や表現の理解、企業のマーケティング担当者の不足している知識の吸収、
定量調査における最重要な項目に関する示唆を得るなどの目的で実施される\cite{2018-ci}。
主に深層面接法(デプス・インタビュー)や集団面接法(グループ・インタビュー)といった、
インタビュアーが回答者との対話を通じて質問をし回答を得る方法が一般的である。
そのため、調査対象者が日常生活であまり気に留めていないことや、
誰かに問いかけられて初めて気づくことなどを収集することができ\cite{2018-ci}、
マーケティング担当者の周辺知識では想定しきれなかった因果関係を発見できる可能性がある。
一方で、定性調査は定量調査と比べて一般的に時間や費用が多くかかることや、
定量的な評価ができず、得られた意見や行動の一般性・代表性に関する議論ができないことなどの
デメリットがある。

定量調査では、主にアンケート調査に代表される意識データや、
(ID付き)POSデータ、Webページ等へのアクセスログなどの行動データが用いられる。
定量データを用いて因果関係に関する情報を得る一般的な方法は
ランダム化比較試験を中心とした実験研究である。
しかし、実験を行うためにはマーケティング施策を実際に行ってみたりする必要があるため、
非常に多くのコストがかかる場合や実験を行うことが難しい場合が多い。
そのため、観察データによって消費者行動の因果関係を評価することが一般的である。
観察データによって因果関係を評価する手法としては、
一般化線形モデル(generalized linear model, GLM)や
構造方程式モデル(structural equation model, SEM)を用いることが多い\cite{2015-pb}\cite{2009-qw}。
GLMでは、目的変数と説明変数の関係を定式化し、
各係数を目的変数に対する説明変数の因果関係の大きさとして解釈を行うことが慣例となっている。
しかし、宮川(2004)\cite{2004-qj}で述べられている通り、
GLMは説明変数を与えたときの目的変数の条件付き確率分布に関するモデルである。
つまり、GLMによる分析の目的は、説明変数を観測したときの目的変数の予測であり、
説明変数に外的操作を行ったときの目的変数の因果効果の定量化ではない。
そのため、推定されたパラメータに対して因果的な解釈を行うことは誤りとなる可能性がある。
一方で、SEMはデータの生成過程を記述した統計的因果モデルであり、
その係数は単なる相関関係の尺度ではなく、因果的な解釈を行うことができる\cite{2004-qj}。
ただし、SEMは分析者の事前知識を積極的に利用することで因果構造の仮説を有向グラフで表現した上で、
その構造に対してモデリングを行う手法である。
つまり、SEMは上述の(ii)因果構造が既知である下で因果関係の大きさの推定を行う手法であると言える。
そのため、分析者側の事前知識の質や量が因果構造の仮説構築に影響し、
妥当だと思われるモデルを得るまでに長い時間を要したりしているという現状がある。
また、近年の社会の発展により消費者の行動は複雑化しており、
そもそも因果構造に関する仮説を構築すること自体が難しい場合も少なくない。


\subsubsection{統計的因果探索}

統計的因果探索とは、因果構造が未知である際に、
どのような条件の下で観測データから因果構造を復元することが可能であるかを明らかにし、
観測データがその条件を満たしているという仮定の下で、
因果構造を推定する手法を研究する学問分野である。
マーケティング・サイエンスを含む多くの実質科学の分野では、
様々な現象の因果関係に関する分析が行われているが、
因果仮説を1つに絞りきれない場合や、
その分野の背景理論が不足しており因果仮説を立てられない場合がある。
そのような場合に統計的因果探索が活用できることが期待されている\cite{2017-zx}。

統計的因果探索の分野において、因果関係を復元するための手がかりの1つは、
因果構造の特徴を示す統計的関連性(条件付き独立性)のパターンである\cite{Pearl2009-oh}。
例えば、2つの公平なサイコロを振った時に得られる結果をそれぞれ$A, B$とし、
2つのサイコロの出た目の合計を$C$とする。
この時、$A$と$C$、$B$と$C$は従属しているが、
$A$と$B$は独立であるという3つの統計的関連性が得られる。
しかし、$C=6$という状況の下では$A$と$B$は従属する。
このことを直感的にグラフに表現すると、
$A \rightarrow C \leftarrow B$となる。
実際、$C=A+B$であるため、$A$と$B$は$C$の原因である。
つまり、統計的関連性を用いることで、
因果構造を復元することが可能な場合があると言える。
しかし、因果構造が異なる場合でも
観測データから同じ条件付き独立関係が得られる場合も多い。
例えば、
$X \rightarrow Y \rightarrow Z$、
$X \leftarrow Y \rightarrow Z$、
$X \leftarrow Y \leftarrow Z$という3つの異なる因果構造から生成された観測データは、
全て「$Y$で条件付けると$X$と$Z$が独立である$(X \indep Z | Y)$」という
条件付き独立関係のみが得られる。
つまり、条件付き独立性を用いるだけでは3つの因果構造を識別することができない。
この条件付き独立性から区別できない因果構造のことをマルコフ同値類(観察的同値類)と言う\cite{Pearl2009-oh}。
そのため、一般に観察データから因果構造を一意に復元することは非常に困難であると言える。

そこで、データ生成過程に関する様々な仮定をおくことで、
因果構造を一意に復元できる識別可能な因果モデルが複数示されている。
観測変数が全て連続である場合は、
変数間の関係性を表す関数が線形であり、外生変数の分布が非正規分布であることを仮定した
線形非ガウス非巡回有向モデル(linear non-Gaussian acyclic model, LiNGAM)\cite{Shimizu2006-yu}、
関数形が非線形であることを仮定した誤差加法モデル(additive noise model, ANM)\cite{Hoyer2008-oo}や
ポスト非線形因果モデル(post-nonlinear causal model, PNL)\cite{Zhang2012-ay}、
関数形が線形であり誤差変数の分散が全て等しい、または全て既知である正規線形構造方程式モデル\cite{Peters2013-eb}
などが挙げられる。

次に、観測変数が全て離散である場合は、
各変数の条件付き分布がポアソン分布に従うことを仮定した
Poisson DAGモデル\cite{Park2015-tj}、
関数形にブール関数などの離散変数を扱う関数を仮定したANM\cite{Peters2011-ew}
などが挙げられる。

最後に、連続変数と離散変数が混在する場合の研究について述べる。
各変数の条件付き分布の分散が期待値の2次式で表現できるという
2次分散関数(quadratic vaiance function, QVF)DAGモデル\cite{Park2017-hw}がある。
これはPoisson DAGモデル\cite{Park2015-tj}を拡張することによって
識別可能性が示されている。
分散が期待値の2次式で表現できる分布には、
ポアソン分布や二項分布、幾何分布などの離散確率分布だけでなく、
指数分布やガンマ分布などの連続確率分布も含まれており、
連続変数と離散変数が混在する場合でも適用できる手法である。
ただし、各変数の条件付き分布については事前に仮定をおく必要がある。
また、離散変数が2値(0,1)であることを仮定したモデルには、
混合因果モデル(mixed causal model)\cite{Wenjuan2018-nm}や
ハイブリッド因果モデル(hybrid causal model)\cite{Li2018-aw}
などがある。
ただし、これらのモデルは一般的な$p$変数における識別可能性は示されていない。
