%!TEX root = ../thesis.tex

\subsection{提案モデル}

提案モデルにおける変数は、離散変数と連続変数に分けられ、
離散変数は0以上の整数を取る確率変数であると仮定する。
そこで提案モデルを以下のように定義する。

\begin{df}[提案モデル] \label{prop_model}
  $p$個の観測変数$X = \{ X_1, \dots, X_p \}$は
  DAGによって表現されるデータ生成過程から生成されており、
  各変数の親変数がその変数の直接的な原因である。
  また、$p$個の観測変数$X = \{ X_1, \dots, X_p \}$は、
  連続変数($X_j \in \mathbb R$)か離散変数($X_j \in \{0, \mathbb N$\})の
  いずれかに割り当てられ、
  それぞれ以下のデータ生成過程により生成されている。

  \begin{enumerate}
    \setlength{\itemsep}{0.3cm}
    \item
    連続変数に割り当てられた変数$X_j$は、
    その親変数$Pa(j)$と誤差変数$e_j$の線形和である。

    \begin{equation}
      X_j = e_j + \theta_{j} + \sum_{k \in Pa(j)} \theta_{jk}X_k
      \quad \text{with} \quad e_j \sim \text{non-Gaussian}
      \label{eq:lingam_prop}
    \end{equation}

    それぞれの係数$\theta_{jk}$は、変数$X_k$から変数$X_j$への直接的な因果効果の大きさを表す。
    また、誤差変数$e_j$は非ガウス分布に従う確率変数であり、お互いに独立である。

    \item
    離散変数に割り当てられた変数$X_j$は、
    その親変数$Pa(j)$による条件付き確率が、2次分散関数性を満たす。
    つまり、以下を満たすような$\beta_{j0},\beta_{j1} \in \mathbb{R}$が存在する。

    \begin{equation}
      \mathit{Var}(X_j|X_{Pa(j)}) = \beta_{j0} E(X_j | X_{Pa(j)}) + \beta_{j1} E(X_j | X_{Pa(j)})^2
      \label{QVF_prop}
    \end{equation}

    また、各変数の条件付き期待値は、
    その変数の親変数$Pa(j)$と
    任意の単調で微分可能なリンク関数$g_j \colon \mathcal X_{Pa(j)} \rightarrow \mathbb R^+$
    によって以下のように記述される。
    ただし、全ての$k \in Pa(j)$について$|\theta_{jk}| > 0$とする。
    \begin{equation}
      E(X_j | X_{Pa(j)})
      = g_j(X_{Pa(j)})
      = g_j \left(\theta_j + \sum_{k \in Pa(j)} \theta_{jk}X_k \right)
    \end{equation}

    ここで、モデルの解釈性を優先させるため、
    リンク関数$g_i$はパラメータ$\theta$に関して線形な関数であることを仮定しているが、
    以降の識別可能性の議論などではそのような仮定は必要ではない。
  \end{enumerate}
\end{df}

マーケティング・リサーチの文脈において、上記のような因果モデルが有用であると考えられるかについて述べる。
まず第一に、消費者行動の研究のうち、「消費者の知覚、選好および選択」を扱った分野との親和性である。
消費者の知覚・選好・選択モデルは、消費者がどのようにブランドを理解し、
そのブランドに対してどのような態度形成を経て購買に至るかをモデル化したものであり、
具体的には「選好回帰分析」や「コンジョイント分析」といった手法によって分析が行われる\cite{1987-vg}。
これらの分析の基礎的な考え方に「多属性態度モデル」が採用されており、それは以下のように表される。
\begin{equation}
  U_j = a_1 z_{1j} + a_2 z_{2j} + \dots + a_l z_{lj}
\end{equation}
ここで、$U_j$は対象$j$に対する態度、$z_{ij}$を対象$j$の第$i$属性の水準、
$a_i$を第$i$属性に対する消費者の重視度である。
例えば、ペットボトル入りの緑茶飲料に対する購入意向(態度)を、
苦み・渋み・甘みなどの消費者が感じる味覚の良し悪し(属性の水準)と、
各属性に対する消費者の重視度の線形加重和で表そうとするモデルである。
本論文の提案モデルにおける連続変数のデータ生成過程の定義である式(\ref{eq:lingam_prop})は、
選好回帰分析やコンジョイント分析が前提としている考え方を表現していると言える。
通常、$U_j$や$z_{ij}$のデータは、2〜7段階尺度(「あてはまる」〜「あてはまらない」など)で評価した
データが用いられる\cite{1987-vg}\cite{2018-ci}。
これらのデータは本来連続量である態度や評価を便宜的にいくつかの段階に分割した
順序付きカテゴリカルデータであり、
通常、各カテゴリに等間隔の数値を割り当て、割り当てられた値自体をデータとして
回帰分析や因子分析を行うことが多い。
この方法には批判もあるが、相関係数の推定精度の観点などから、
5段階以上の尺度であれば連続変数と同様に扱っても大きな問題とはならないという結果も見られる\cite{1996-bs}。
そのため、本論文では5段階以上の尺度で得られたデータは連続変数として扱う。

第二に、カウント(計数)データを扱えることである。
マーケティング・リサーチにおいては、商品の購買個数やWebページへの訪問回数、インターネット広告への接触回数など、
ある事象が発生した回数を記録したカウントデータを扱うことが多い。
これらのデータに対しては、ポアソン回帰モデルを用いた分析などが用いられる。
例えば、ある商品の販売点数を目的変数とし、その商品価格や小売店における山積み陳列実施の有無などを説明変数とした
モデルによって市場反応分析を行うことなどが挙げられる\cite{2015-pb}。
また、非耐久消費財の購入に関するデータは負の二項分布を用いてモデル化することができることが示されており\cite{Ehrenberg1959-ei}、
負の二項分布モデルを拡張したディリクレモデルを用いてブランドの購入率や購入回数を分析したりする事例も見られる\cite{2016-io}。
本論文の提案モデルにおける離散変数のデータ生成過程の性質を満たす分布には、
ポアソン分布や二項分布、負の二項回帰などが含まれており、
マーケティング・リサーチの分野において活用しやすいと考えられる。
