%!TEX root = ../thesis.tex

\subsection{2次分散関数 (QVF) DAGモデル}

本節では、Park and Raskutti(2017)\cite{Park2017-hw}によって提案された
2次分散関数 (QVF) DAGモデルについて概説する。
QVF-DAGモデルは、各頂点の親による条件付き分布$\mathcal P$の分散が、
平均の2次式で与えられているというモデルであり、
以下のように定義される。

\begin{df}[QVF-DAGモデル\cite{Park2017-hw}]
2次分散関数(Quadratic variance function, QVF)DAGモデルは、
各頂点の親による条件付き確率分布が、
以下で表現される2次分散関数性(quadratic variance function property)を
満たすようなDAGモデルである。

すべての$j \in V$について、以下を満たすような$\beta_{j0}, \beta_{j1} \in \mathbb R$が存在する。
\begin{equation}
\mathit{Var}(X_j|X_{Pa(j)}) = \beta_{j0} E(X_j | X_{Pa(j)}) + \beta_{j1} E(X_j | X_{Pa(j)})^2
\label{QVF}
\end{equation}
\end{df}

また、本論文の後半では、各頂点間の関係について線形性を仮定するため、
QVF-DAGモデルの特殊系として、
QVF構造方程式モデル(structural quation model, SEM)を導入する。
QVF-SEMは、一般化線形モデル(GLM)のように各頂点のパラメータについて線形な関係を仮定したものである。

\begin{equation}
  \begin{align}
    E(X_j | X_{Pa(j)}) &= \mu_j \\
    g_j(\mu_j) &= \theta_j + \sum_{k \in Pa(j)} \theta_{jk}X_k
  \end{align}
\end{equation}

ここで、$g_j$はリンク関数、
$(\theta_{jk})_{k \in Pa(j)}$は重み付け係数である。
例えば、ポアソン分布による一般化線形モデルの場合、
$\mu_j = \exp(\theta_j + \sum_{k \in Pa(j)} \theta_{jk}X_k)$
となる。

より一般的には、指数分布族の定義を用いて、以下のように表現することができる。
\begin{equation}
  P(X_j|X_{Pa(j)}) = \exp \left( \theta_{jj}X_j  + \sum_{(k,j)\in E} \theta_{jk}X_k X_j -
  B_j(X_j) - A_j \left( \theta_{jj} + \sum_{(k,j) \in E} \theta_{jk} X_k \right) \right)
\end{equation}

ここで、$A_j(\cdot)$は対数分配関数(log-partition function)、
$B_j(\cdot)$は指数分布族によって決まる関数、
$\theta_{jk}\in \mathbb R$は頂点$j$に対応するパラメータである。
DAGモデルの因数分解(\ref{eq:factorization})式により、QVF-DAGモデルの同時確率分布は、
以下のように記述することができる。

\begin{equation}
  P(X) = \exp \left( \sum_{j\in V} \theta_{jj}X_j + \sum_{(k,j)\in E} \theta_{jk}X_k X_j
  - \sum_{j \in V} B_j(X_j) - \sum_{j \in V} A_j
  \left( \theta_{jj} + \sum_{(k,j)\in E} \theta_{jk} X_k \right)\right)
  \label{eq:QVF_factorization}
\end{equation}

このモデルは、各条件付き分布がそれぞれ異なる分布に従っているような混合DAGモデルにも拡張することが可能である。
また、各頂点の分布$\mathcal P$が(\ref{QVF})式で定義される2次分散関数性を満たす場合、
非線形モデルやノンパラメトリックモデルに拡張することも可能である。
