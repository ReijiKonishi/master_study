%!TEX root = ../thesis.tex

\subsection{設定}

本論文では、サンプルサイズ$n = \{ 100, 250, 500, 1000, 1500, 2000, 2500 \}$、
頂点数$p = \{ 5, 10 \}$、
連続変数の誤差変数の分布 \{正規分布, 一様分布\} であるデータセットを、
提案モデルに従ってそれぞれ100個ずつ生成した。
その他のデータ生成や推定における設定の詳細は以下とした。

\begin{enumerate}
  \setlength{\itemsep}{0.3cm}
  \item
  $p$個の変数をランダムに連続変数と離散変数に割り当てた。
  連続変数に割り当てられる確率は0.6、離散変数に割り当てられる確率は0.4とした。
  また、離散変数はポアソン分布と二項分布のいずれかに確率0.5で割り当てた。
  ただし、二項分布のパラメータは
  Park and Raskutti(2017)\cite{Park2017-hw}と同様に$N_j=4$に固定した。

  \item
  グラフの構造をランダムに生成するために、
  まず全ての要素が0である$p\times p$隣接行列を生成した。
  次に、Kalisch and B\"{u}hlmann(2007)\cite{Kalisch2007-xg}と同様に、
  成功確率$s$に従う独立なベルヌーイ試行に基づいて
  隣接行列の下三角成分を1に置き換えた。
  成功確率$s$は、各変数と隣接する変数の個数の期待値が2または5になるように
  ランダムに設定した
  \footnote{各変数と隣接する変数の個数の期待値は$s(p-1)$である\cite{Kalisch2007-xg}}。
  隣接行列のゼロ・非ゼロパターンは、
  提案モデルにおける変数間の関係性の強さを表すパラメータ$\theta_{jk}$の
  ゼロ・非ゼロパターンと同じである。

  \item
  提案モデルにおける非ゼロのパラメータ$\theta_{jk} \in \mathbb R$は、
  範囲$\theta_{jk} \in [-0.5,-0.2]\cup [0.2,0.5]$からランダムに選択した。
  また、定数項$\theta_j$は、範囲$\theta_j \in [-0.5,0.5]$からランダムに選択した。

  \item
  連続変数のデータ生成過程における誤差変数の分散$\sigma_j^2$は、
  範囲$\sigma_j^2 \in [0.7,0.8]$からランダムに選択した。

  \item
  離散変数の因果順序を推定する際の閾値は1.01とした。

  \item
  各変数の親変数との関係性の強さを推定する際の
  adaptive Lassoの調整パラメータについて、
  $\lambda$は10分割交差検証によって選択した。
  具体的には、「最小の逸脱度(deviance) +標準誤差」を超えない
  最大の$\lambda$を選択した。
  また、$\gamma$は1に固定した。
\end{enumerate}

既存のDAG推定アルゴリズムには、
Greedy Equivalent Search (GES)\cite{Chickering2002-iq}、
Max-Min Hill-Climbing (MMHC)\cite{Tsamardinos2006-qe}、
DirectLiNGAM\cite{Shimizu2011-pd}、
を用いた。
DAGを推定するアルゴリズムは、制約に基づくアプローチ(constraint-based approach)と
スコアに基づくアプローチ(score-based approach)に大別される。
GESはスコアに基づくアプローチであり、
ベイズ情報量規準(Bayesian Information Criterion; BIC)を用いて
モデルの当てはまりが最も良いマルコフ同値類を推定する方法である。
MMHCは制約に基づくアプローチとスコアに基づくアプローチの両方を組み合わせた
ハイブリッドなアルゴリズムである。
具体的には、まず制約に基づくアプローチによって各変数の親候補と子候補を求め、
次にスコアに基づくアプローチによってモデルの当てはまりが最も良いマルコフ同値類を推定する。
1段階目として制約に基づくアプローチによって親候補と子候補を求めることによって、
2段階目のスコアに基づくアプローチの際の探索空間を小さくしていることが特徴である。
DirectLiNGAMはLiNGAM\cite{Shimizu2006-yu}に特化したアルゴリズムであり、
回帰分析と独立性の評価を繰り返すことによって因果順序を推定する。

DAGの推定精度は、適合率(precision)と再現率(recall)によって測定した。
適合率と再現率の算出方法は以下の通りである。
\begin{itemize}
  \item 適合率(precision)
  \begin{equation*}
    \frac{\text{正しく推定された辺の個数}}{\text{推定されたDAGにおける辺の個数}}
  \end{equation*}

  \item 再現率(recall)
  \begin{equation*}
    \frac{\text{正しく推定された辺の個数}}{\text{真のDAGにおける辺の個数}}
  \end{equation*}
\end{itemize}
ただし、GESとMMHCはマルコフ同値類を推定するアルゴリズムであるため、
推定されたグラフの一部の辺は無向辺のままである。
そのため、本論文ではPark and Park(2019)\cite{Park2019-qy}と同様に、
推定されたマルコフ同値類すべてにおける適合率と再現率の平均値で評価する。
